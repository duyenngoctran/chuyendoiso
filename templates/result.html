<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Kết quả phân tích</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://demo.themesberg.com/volt/css/volt.css" />
  <style>
    body { background-color: #f7f9fc; font-family: "Inter", sans-serif; }
    .navbar { background: white; box-shadow: 0 1px 6px rgba(0,0,0,0.05); }
    .navbar-brand { font-weight: 600; color: #2563eb !important; }
    .card { border:0; border-radius:16px; box-shadow:0 2px 8px rgba(0,0,0,0.05);}
    footer { border-top:1px solid #e5e7eb;text-align:center;font-size:14px;color:#6b7280;padding:20px 0;margin-top:60px;}
    .badge { border-radius:12px; }

    /* ====== Bảng: tối ưu UX không kéo ngang ====== */
    .table-wrap { max-height: 600px; overflow-y: auto; }        /* chỉ scroll dọc */
    table { table-layout: fixed; width: 100%; }                  /* ép cột co hợp lý */
    th, td { vertical-align: middle; }
    thead th {                                                   /* header dính trên cùng */
      position: sticky; top: 0; z-index: 1;
      background: #f3f4f6;
    }
    /* Cột văn bản: cho phép xuống dòng, không đẩy bảng sang ngang */
    td.text-col {
      white-space: normal;
      word-break: break-word;
      overflow-wrap: anywhere;
      max-width: 0;   /* để table-layout:fixed phân bổ phần còn lại cho cột này */
    }
    /* Cột số liệu & nhãn: căn giữa + độ rộng ổn định */
    th.prob, td.prob, th.label, td.label { text-align: center; }
    th.prob, td.prob { width: 140px; }
    th.label, td.label { width: 120px; }
    /* Hàng kẻ nhẹ giúp đọc dễ hơn */
    tbody tr:nth-child(even) { background-color: #fafafa; }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg mb-4">
  <div class="container">
    <a class="navbar-brand" href="{{ url_for('index') }}">Phân tích cảm xúc</a>
  </div>
</nav>

<div class="container-xl">
  <div class="row g-4">
    <div class="col-md-4">
      <div class="card text-center py-3">
        <h6 class="fw-semibold text-success mb-1">Tích cực</h6>
        <h4 class="fw-bold mb-0">{{ pos }}</h4>
        <small class="text-muted">{{ pos_pct }}%</small>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center py-3">
        <h6 class="fw-semibold text-danger mb-1">Tiêu cực</h6>
        <h4 class="fw-bold mb-0">{{ neg }}</h4>
        <small class="text-muted">{{ neg_pct }}%</small>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center py-3">
        <h6 class="fw-semibold text-secondary mb-1">Tổng</h6>
        <h4 class="fw-bold mb-0">{{ total }}</h4>
      </div>
    </div>
  </div>

  <div class="card mt-4 p-4">
    <h5 class="fw-semibold mb-3">Chi tiết dự đoán</h5>

    <div class="table-wrap table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th style="width:60px;">#</th>
            <th>Văn bản</th>
            <th class="prob">Xác suất POS</th>
            <th class="label">Nhãn</th>
          </tr>
        </thead>
        <tbody>
          {% for row in tables %}
          <tr>
            <td>{{ loop.index }}</td>
            <td class="text-col">{{ row['text'] }}</td>
            <td class="prob">{{ "%.2f"|format(row['prob_pos']*100) }}%</td>
            <td class="label">
              {% if row['pred_label']=='pos' %}
                <span class="badge bg-success">Tích cực</span>
              {% else %}
                <span class="badge bg-danger">Tiêu cực</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <a class="btn btn-primary me-2" href="{{ url_for('download', filename=filename) }}">Tải file kết quả</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('index') }}">Phân tích lại</a>
      <a href="{{ url_for('chart') }}" class="btn btn-success">Xem biểu đồ</a>
    </div>
  </div>
</div>

<footer>  © 2025 Trần Ngọc Duyên | CNTT 16_05 - Đại Học Đại Nam</footer>
<script src="https://demo.themesberg.com/volt/js/volt.js"></script>
</body>
</html>
